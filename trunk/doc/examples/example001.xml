<section id="examples.example1"><title>Calculate average coordinates of trajectory frames</title>

	<para>This example takes the supplied water trajectory and determines the average coordinates of all the individual water molecules. Note that no accounting for the periodicity of the system is taken into account.</para>

	<example><title>Average Coordinates</title>
		<programlisting>
vector xyz[aten.model.natoms];
int nframes = aten.model.nframes;
int natoms = aten.model.natoms;
printf("NUmber of frames is %i\n", nframes);
for (model f = aten.model.frames; f; ++f)
{
	for (int n=1; n&lt;=natoms; ++n) xyz[n] += f.atoms[n].r;
}
for (int n=1; n&lt;=natoms; ++n) xyz[n] = xyz[n] / nframes;
model f = aten.model.frames;
newmodel("Average");
for (int n=1; n&lt;= natoms; ++n) newatom(f.atoms[n].z, xyz[n].x, xyz[n].y, xyz[n].z);
		</programlisting>
	</example>
	<para>To run the example:</para>

	<synopsis>
aten --zmap singlealpha data/test/water66-spcfw.CONFIG -t data/test/water66-spcfw.HISu -s avgeom.txt
	</synopsis>

</section>
