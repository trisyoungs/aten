<section id="tutorials.saltwater"><title>Creating an Extended Two-Phase System (NaCl/Water)</title>
	<indexterm><primary>building</primary></indexterm>
	<indexterm><primary>salt</primary></indexterm>
	<indexterm><primary>crystals</primary></indexterm>
	<indexterm><primary>cell manipulation</primary></indexterm>
	<indexterm><primary>interfaces</primary></indexterm>
	<indexterm><primary>disordered building</primary></indexterm>
	
	<para>It's often necessary to create a larger system from a simple (or complex) unit cell, for example to generate bulk supercells of crystals, sufaces etc. The method outlined below shows how to do this for a simple crystal (sodium chloride), using some cell manipulation techniques along the way. Then, we'll create a surface and then randomly add in water molecules to create an interfacial system.</para>

	
	<sect5><title>1. Create the Template Model</title>
		
		<para>First off, we will create a basic FCC template model which has a unit cell of exactly 1 &#197;, with four sodium atoms at {0,0,0}, {0.5,0.5,0}, {0.0,0.5,0.5}, and {0.5,0.0,0.5}, representing the basic positions of atoms in a face-centred cubic lattice.</para>

		<table frame='all' pgwide='1' tocentry='0'>
			<tgroup cols='2' align='left' colsep='0' rowsep='0'>
				<tbody>
					<row>
						<entry><inlinegraphic fileref="images/stack_celledit.png"/></entry>
						<entry>Open the Cell Edit window</entry>
					</row>
					<row>
						<entry></entry>
						<entry>Add a unit cell to the model by checking the 'Has Cell?' checkbox.</entry>
					</row>
					<row>
						<entry></entry>
						<entry>Set the cell lengths <emphasis>A</emphasis>, <emphasis>B</emphasis>, and <emphasis>C</emphasis> to 1.0</entry>
					</row>
					<row>
						<entry><emphasis>Build Toolbar</emphasis></entry>
						<entry>On the Build toolbar change the active element to sodium by clicking the <inlinegraphic fileref="images/build_element.png"/> button and selecing it in the periodic table.</entry>
					</row>
					<row>
						<entry><inlinegraphic fileref="images/stack_build.png"/></entry>
						<entry>Open the Build window</entry>
					</row>
					<row>
						<entry></entry>
						<entry>
							<para>On the Add Atom page enter the following sets of coordinates, clicking 'Add' after each set is entered:</para>
							<para>x = 0.0, y = 0.0, z = 0.0</para>
							<para>x = 0.5, y = 0.5, z = 0.0</para>
							<para>x = 0.0, y = 0.5, z = 0.5</para>
							<para>x = 0.5, y = 0.0, z = 0.5</para>
						</entry>
					</row>
				</tbody>
			</tgroup>
		</table>
		
		<figure><title>Initial FCC cell</title>
			<graphic fileref="images/tutorial_saltwater1.png" align="center"/>
		</figure>
			
	</sect5>
	
	<sect5><title>2. Duplicate Atoms to Create NaCl-like Cell</title>
		
		<para>Since the sodium and chlorine atoms in NaCl lay on their own interpenetrating FCC lattices, we can create the chlorine atoms by manipulating the four sodium atoms. We can copy and paste the current atoms, and then flip them about their centre's x-axis to get them in the correct position. Then, they can be transmuted into chlorines.</para>
		
		<table frame='all' pgwide='1' tocentry='0'>
			<tgroup cols='2' align='left' colsep='0' rowsep='0'>
				<tbody>
					<row>
						<entry><emphasis>Edit Menu</emphasis></entry>
						<entry>On the Edit Menu, select 'Select All' (or press Ctrl-A while the mouse is in the main view)</entry>
					</row>
					<row>
						<entry></entry>
						<entry>Now paste the copied atoms back into the model by selecting 'Paste' from the Edit Menu, or pressing Ctrl-V while the mouse is in the main view. Note that the pasted atoms will overlap the original atoms, but will be selected. Take care not to remove this selection by clicking in the model.</entry>
					</row>
					<row>
						<entry><inlinegraphic fileref="images/stack_position.png"/></entry>
						<entry>Open the Atom Position window</entry>
					</row>
					<row>
						<entry></entry>
						<entry>On the 'Flip' page, select the x-flip button <inlinegraphic fileref="images/position_flipx.png"/> (leftmost of the three)</entry>
					</row>
					<row>
						<entry><emphasis>Build Toolbar</emphasis></entry>
						<entry>On the Build toolbar change the active element to chlorine by clicking the <inlinegraphic fileref="images/build_element.png"/> button and selecing it in the periodic table.</entry>
					</row>
					<row>
						<entry><emphasis>Build Toolbar</emphasis></entry>
						<entry>On the Build toolbar, select the transmute tool <inlinegraphic fileref="images/build_transmute.png"/></entry>
					</row>
					<row>
						<entry></entry>
						<entry>Click once on each of the four selected atoms to change them from sodium into chlorine</entry>
					</row>
				</tbody>
			</tgroup>
		</table>

		<figure><title>Interpenetrating NaCl FCC lattices</title>
			<graphic fileref="images/tutorial_saltwater2.png" align="center"/>
		</figure>
		
	</sect5>

	<sect5><title>3. Scale and Replicate Unit Cell</title>
		
		<para>We wish to scale the cubic unit cell of the model (currently with side length <emphasis>l</emphasis> = 1.0 &#197;) to correspond to the unit cell of sodium chloride (<emphasis>l</emphasis> = 5.628 &#197;). The cell can be scaled by a different amount in each Cartesian axis, but since we want to end up with a cubic cell we must scale each axis by the same amount.</para>
		
		<para>Once the model represents proper the basic sodium chloride unit cell we can replicate it to create a larger system. Aten can replicate a basic cell by any integer or non-integer amount in each of the three principal cell axes, but here we will stick to integer amounts. The Replicate method also allows specification of both negative and positive replication amounts for each direction.</para>
		
		<para>For this example, we'll replicate by four additional whole cell units in x and z and one in y. Note that the values given in the Replicate page represent the <emphasis>total</emphasis> size which we require, so input values (negative/positive) of {0,0,0} and {1,1,1} will result in an unchaged cell. Also, feel free to ignore these suggested numbers and put in really large ones to cripple your machine!</para>
		
		<table frame='all' pgwide='1' tocentry='0'>
			<tgroup cols='2' align='left' colsep='0' rowsep='0'>
				<tbody>
					<row>
						<entry><inlinegraphic fileref="images/stack_celltransform.png"/></entry>
						<entry>Open the Cell Transform window</entry>
					</row>
					<row>
						<entry></entry>
						<entry>On the Scale page, set the x, y, and z values to 5.628, and then press the 'Scale' button.</entry>
					</row>
					<row>
						<entry><emphasis>Style Toolbar</emphasis></entry>
						<entry>For a better view of the system, change the atom style to scaled <inlinegraphic fileref="images/style_scaled.png"/></entry>
					</row>
					<row>
						<entry><inlinegraphic fileref="images/stack_celledit.png"/></entry>
						<entry>Open the Cell Edit window</entry>
					</row>
					<row>
						<entry></entry>
						<entry>On the Replicate page, set the positive x and z values to 5 and the y value to 2 and then press the 'Replicate' button.</entry>
					</row>
				</tbody>
			</tgroup>
		</table>
		
		<figure><title>Scaled and Replicated FCC Cell</title>
			<graphic fileref="images/tutorial_saltwater3.png" align="center"/>
		</figure>
	
	</sect5>
	
	<sect5><title>4. Create an Interface</title>
		
		<para>It's a simple job to create an interface from the current system - all we need do is increase the cell dimension along the y direction (the cell's <emphasis>B</emphasis> length). In the example below, the <emphasis>B</emphasis> length is changed to 28.14 &#197; in order to correspond to the <emphasis>A</emphasis> and <emphasis>C</emphasis> lengths and give a cubic system, but any value will do. However, remember that the next step (adding the water) will take longer the larger the volume of the cell.</para>
		
		<table frame='all' pgwide='1' tocentry='0'>
			<tgroup cols='2' align='left' colsep='0' rowsep='0'>
				<tbody>
					<row>
						<entry><inlinegraphic fileref="images/stack_celledit.png"/></entry>
						<entry>Open the Cell Edit window</entry>
					</row>
					<row>
						<entry></entry>
						<entry>Modify the current cell <emphasis>B</emphasis> value to be 28.14</entry>
					</row>
				</tbody>
			</tgroup>
		</table>
		
		<figure><title>NaCl slab</title>
			<graphic fileref="images/tutorial_salt4.png" align="center"/>
		</figure>
		
	</sect5>
	
	<sect5><title>5. Make a Water Model</title>
		
		<para>We will now create a water molecule in a separate model so we can add it in to the NaCl cell using the Disordered Builder.</para>
		
		<table frame='all' pgwide='1' tocentry='0'>
			<tgroup cols='2' align='left' colsep='0' rowsep='0'>
				<tbody>
					<row>
						<entry><emphasis>File Toolbar</emphasis></entry>
						<entry>On the File toolbar click <inlinegraphic fileref="images/file_new.png"/> to create a new, empty model</entry>
					</row>
					<row>
						<entry><emphasis>Build Toolbar</emphasis></entry>
						<entry>On the Build toolbar change the active element to oxygen by clicking the <inlinegraphic fileref="images/build_element.png"/> button and selecing it in the periodic table.</entry>
					</row>
					<row>
						<entry><emphasis>Draw Toolbar</emphasis></entry>
						<entry>Select the draw single atoms tool <inlinegraphic fileref="images/draw_atom.png"/> and click once somewhere in the empty model to draw an oxygen atom</entry>
					</row>
					<row>
						<entry><emphasis>Build Toolbar</emphasis></entry>
						<entry>Add hydrogens to the oxygen atom by clicking on add hydrogens <inlinegraphic fileref="images/build_addh.png"/></entry>
					</row>
				</tbody>
			</tgroup>
		</table>
		
		<figure><title>Single water molecule</title>
			<graphic fileref="images/tutorial_salt5.png" align="center"/>
		</figure>
		
	</sect5>
	
	<sect5><title>6. Add Water to the NaCl Cell</title>
			
		<para>We now return to the original NaCl model, since the current model is the target of the Disordered Builder. We require a forcefield in order to provide the energetic description of the whole system, both the NaCl cell and the water model, and the combination of the two. Both models are quite simple, and the OPLS-AA forcefield will provide all the terms necessary.</para>
			
		<table frame='all' pgwide='1' tocentry='0'>
			<tgroup cols='2' align='left' colsep='0' rowsep='0'>
				<tbody>
					<row>
						<entry><emphasis>Main Window</emphasis></entry>
						<entry>Return to the NaCl model by clicking on the other model tab (probably called 'Unnamed001').</entry>
					</row>
					<row>
						<entry><inlinegraphic fileref="images/stack_ff.png"/></entry>
						<entry>Open the Forcefields Window</entry>
					</row>
					<row>
						<entry></entry>
						<entry>Load the 'oplsaa.ff' forcefield, and close the window</entry>
					</row>
					<row>
						<entry><inlinegraphic fileref="images/stack_disorder.png"/></entry>
						<entry>Open the Disordered Builder window</entry>
					</row>
					<row>
						<entry></entry>
						<entry>In the disordered builder window the available models to add are listed in the list on the left-hand side. For each entry, the number of molecules requested is shown (currently zero) as well as the whether rotation and/or translation moves are allowed for this particular model (the 'R' and 'T' checkboxes respectively. The only change to make is to change the number of requested molecules to 250 (a suitable number if the cell is of similar size to that in this example)</entry>
					</row>
					<row>
						<entry></entry>
						<entry>Once the number of water molecules has been changed, press 'Build' to add in water molecules to the NaCl cell</entry>
					</row>
				</tbody>
			</tgroup>
		</table>
		
		<figure><title>NaCl surface and bulk water</title>
			<graphic fileref="images/tutorial_salt6.png" align="center"/>
		</figure>
			
	</sect5>
	
	<sect5><title>Script</title>
		
		<programlisting>
newmodel("fcc");
cell(1,1,1,90,90,90);
newatom(Na,0,0,0);
newatom(Na,0.5,0.5,0);
newatom(Na,0.5,0,0.5);
newatom(Na,0,0.5,0.5);
selectall();
copy();
paste();
flipx();
transmute(Cl);
scale(5.628,5.628,5.628);
replicate(0,0,0,5,2,5);
setcell("b",28.12);
newmodel("Water");
newatom(O,0,0,0);
addhydrogen();
nmols(250);
firstmodel();
loadff("oplsaa.ff");
disorder(100);
		</programlisting>
		
	</sect5>
	
</section>
