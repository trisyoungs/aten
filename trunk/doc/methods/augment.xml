<section id="methods.augment"><title>Augment</title>
	<indexterm zone="methods.augment"><primary>methods</primary><secondary>augment</secondary></indexterm>

	<para>Augmentation of bonds, as far as Aten is concerned, means to take a collection of atoms with 'basic' connectivity (i.e. all single bonds, as per the result of <link linkend="methods.rebond">rebonding</link>) and assign multiple bonds where necessary. The method is based loosely on previously described algorithms.[1]</para>

	<para>The basis of the method involves modifying the bond order of a particular connection to best satisfy the bonding requirements of the two involved atoms, for example making sure all carbon atoms possess an optimal total bond order of 4. However, many atoms (in particular S and P) happily exist with more than one total bond order (e.g. P) - the methodology borrowed from [1] solves this problem by scoring the total bond order for each particular element ranging from zero (meaning 'natural' or 'no penalty') to some positive number. The higher the positive number, the more 'unhappy' the element is with this number of bonds. For example, hydrogen atoms score 0 for a total bond order of 1, a small positive number (2) for no bonds (hydrogen ion) and a very large positive value (here, 32) for any other bond order. In this way we penalise the total bond orders that an atom does not naturally take on, and always tend towards the lowest score (i.e. the natural total bond order) wherever possible. When modifying the bond order of a particular connection, the total bond order scores of both atoms are calculated once for the current connection and again for the potential new bond order of the connection. If the new score is lower, the change of bond order is accepted.</para>

	<orderedlist>
		<listitem>
			<para>Pattern Detection</para>
			<para>As with many other routines in Aten, a suitable pattern description is first detected for the system in order to isolate individual molecular species and make the algorithm as efficient as possible.</para>
		</listitem>
	
		<listitem>
			<para>Augmentation of Terminal Bonds</para>
			<para>Bonds that involve a heavy (i.e. non-hydrogen) atom connected to no other atoms (e.g. C=O in a ketone) are treated before all others. The bond order is modified such that the total bond order score for both atoms is as low as possible.</para>
		</listitem>

		<listitem>
			<para>Augmentation of Other Bonds</para>
			<para>Following optimisation of terminal bonds, all other bonds are modified using exactly the same procedure.</para>
		</listitem>
	
		<listitem>
			<para>Second Stage Augmentation</para>
			<para>The above two steps are enough to correctly determine multiple bonds in a chemically-correct molecule, provided no cyclic moities are present in the system. The second stage is designed to correct improper augmentations within cycles, or shift existing augmentations around cycles such that other (missing) multiple bonds may be created.</para>
	
			<para>For each existing multiple bond in each cyclic structure in each pattern's molecule, a simple re-augmentation of the constituent bonds is first attempted in order to try and lower the total bond order score for the whole ring (i.e. the sum of the individual bond order scores of every atom present in the cycle). Then, each bond in the ring is considered in sequence. If the bond is a double bond, then we attempt to convert this into a single bond and make the two adjacent bonds in the ring double bonds in an attempt to 'aromaticise' the ring. The total bond order score is checked and, if lower than the previous score, the change is accepted. If not, the change is reversed and the next bond is considered. By performing these secondary adjustments the double-bond pattern of many complex (poly)aromatics can be correctly (and fully automatically) detected.</para>
		</listitem>
	</orderedlist>

	<para>[1] &quot;Automatic atom type and bond type perception in molecular mechanical calculations&quot;, J. Wang, W. Wang, P. A. Kollman, and D. A. Case, ''Journal of Molecular Graphics and Modelling'', <emphasis>25</emphasis> (2), 247-260 (2006).</para>

</section>