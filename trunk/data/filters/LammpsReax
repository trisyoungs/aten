# LAMMPS REAX
# Created:  12/1/2013
# Last modified: 12/1/2013
# ChangeLog:
# Notes:
#	data file for ReaxFF in LAMMPS

filter(type="exportmodel", name="LAMMPS_data.input", nickname="lammps", extension="input", glob="*.input", id=22)
{
	# Variable declaration
	int n, el[aten.nElements], nSpecies;
	string e;
	double rx,ry,rz;
	atom i;

	# Grab current model (or frame)
	model m = aten.frame;

	# Determine number of species (elements) used in model, and create element->species map
	el = 0;
	nSpecies = 0;
	for (i = m.atoms; i; ++i) if (el[i.z] == 0) el[i.z] = ++nSpecies;
	
	# Write Header Masses and Atoms sections
	writeLine("# ReaxFF data file");
	writeLine("");

	writeLineF("%i  atoms\n",m.nAtoms);
	writeLineF("%i  atom types\n",nSpecies);
	writeLine("");

	writeLineF("0 %7.3f  xlo xhi\n",m.cell.a);
	writeLineF("0 %7.3f  ylo yhi\n",m.cell.b);
	writeLineF("0 %7.3f  zlo zhi\n",m.cell.c);

	writeLine("");

	# Write atomic species data
	writeLine("Masses");
	writeLine("");
	for (n=1; n<=aten.nElements; n++) if (el[n] != 0) writeLineF("%1i  %7.4f\n",el[n], aten.elements[n].mass);

	writeLine("");

	# Write atomic positions
	writeLine("Atoms");
	writeLine("");
     for (i = m.atoms; i; ++i) writeLineF("%4i %2i %4.1f %8.5f %8.5f %8.5f\n",i.id,el[i.z],i.q,i.rx,i.ry,i.rz);

     #for (i = m.atoms; i; ++i) writeLineF("%4i %2i  0.0  %8.5f %8.5f %8.5f\n",i.id,el[i.z],i.rx,i.ry,i.rz);
}
