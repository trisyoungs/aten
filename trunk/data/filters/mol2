importmodel
	name "Tripos (Sybyl) Mol2"
	nickname mol2
	extension "mol,mol2"
	glob *.mol*
	# Read in lines, looking for the sections we're interested in.
	# All sections begin with '@<TRIPOS>', e.g. '@<TRIPOS>MOLECULE'
	# Read a line and parse it into '@<TRIPOS>' and keyword parts
	repeat $loop
		readline "$tripos@9 $keywd"
		if $keywd = MOLECULE
			# Molecule information
			readline "$title@100"
			newmodel $title
			readline "$natoms $nbonds"
			# Skip the next three lines, which are type of molecule, charges used XXX, and user comment
			skipline 4
		elseif $keywd = ATOM
			repeat $n $natoms
				readline "$id $e $r.x $r.y $r.z"
				addatom
			end
		elseif $keywd = BOND
			repeat $n $nbonds
				readline "* $ii $jj $bondtype"
				addbond $ii $jj $bondtype
			end
		elseif $keywd = CRYSIN
			# Crystal cell information
			# Single line, format is ' a b c alpha beta gamma spgrp spgrp_setting'
			readline "$cell.a $cell.b $cell.c $cell.alpha $cell.beta $cell.gamma $sg.group $sg.setting"
			setcell
		end
	end
end
